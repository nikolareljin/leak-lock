#!/usr/bin/env sh

# Gradle wrapper bootstrap script with auto-download of gradle-wrapper.jar if missing.

DIR=$(CDPATH= cd -- "$(dirname -- "$0")" && pwd)
WRAPPER_JAR="$DIR/gradle/wrapper/gradle-wrapper.jar"

if [ ! -f "$WRAPPER_JAR" ]; then
  echo "gradle-wrapper.jar missing; attempting to download..." >&2
  mkdir -p "$DIR/gradle/wrapper"
  URL="https://repo1.maven.org/maven2/org/gradle/gradle-wrapper/8.7/gradle-wrapper-8.7.jar"
  if command -v curl >/dev/null 2>&1; then
    curl -fsSL "$URL" -o "$WRAPPER_JAR" || true
  elif command -v wget >/dev/null 2>&1; then
    wget -q "$URL" -O "$WRAPPER_JAR" || true
  fi
fi

CLASSPATH="$WRAPPER_JAR"

# Determine Java command to use to start the JVM.
if [ -n "$JAVA_HOME" ] ; then
    if [ -x "$JAVA_HOME/jre/sh/java" ] ; then
        # IBM's JDK on AIX uses strange locations for the executables
        JAVACMD="$JAVA_HOME/jre/sh/java"
    else
        JAVACMD="$JAVA_HOME/bin/java"
    fi
    if [ ! -x "$JAVACMD" ] ; then
        echo "ERROR: JAVA_HOME is set to an invalid directory: $JAVA_HOME" >&2
        exit 1
    fi
else
    JAVACMD=java
    which java >/dev/null 2>&1 || {
        echo "ERROR: JAVA_HOME is not set and no 'java' command could be found in your PATH." >&2
        exit 1
    }
fi

APP_ARGS="$@"
exec "$JAVACMD" -classpath "$CLASSPATH" org.gradle.wrapper.GradleWrapperMain "$APP_ARGS"

